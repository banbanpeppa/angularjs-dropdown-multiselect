!function(n){function l(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,l),t.loaded=!0,t.exports}var o={};l.m=n,l.c=o,l.p="",l(0)}([function(e,t,n){"use strict";var l,o=n(1),s=(l=o)&&l.__esModule?l:{default:l};angular.module("angularjs-dropdown-multiselect",[]).directive("dmDropdownStaticInclude",["$compile",function(s){return function(e,t,n){var l=n.dmDropdownStaticInclude,o=t.html(l).contents();s(o)(e)}}]).directive("ngDropdownMultiselect",s.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",disabled:"="},transclude:{toggleDropdown:"?toggleDropdown"},controller:s.default,templateUrl:"app/component/angularjs-dropdown-multiselect.html"}};var l,o=n(2),s=(l=o)&&l.__esModule?l:{default:l}},function(e,t){"use strict";function u(e,t){var n=!1;return e.some(function(e){return e===t&&(n=!0)}),n}function g(e,n,l){var o=-1;return e.some(function(e,t){return e[l]===n[l]&&(o=t,!0)}),o}function n(s,i,l,e){function o(){setTimeout(function(){var e=angular.element(i)[0].querySelector(".option");angular.isDefined(e)&&null!=e&&e.focus()},0)}function r(e){var t=i.find("button"),n=document.createElement("canvas").getContext("2d");return n.font=t.css("font-size")+t.css("font-family"),n.originalFont=t.css("font-size")+t.css("font-family"),n.fillStyle="#000000",n.measureText(e).width}var c=i.children()[0],t={onItemSelect:angular.noop,onItemDeselect:angular.noop,onSelectAll:angular.noop,onDeselectAll:angular.noop,onInitDone:angular.noop,onMaxSelectionReached:angular.noop,onSelectionChanged:angular.noop,onClose:angular.noop},a={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"label",enableSearch:!1,clearSearchOnClose:!1,selectionLimit:0,showCheckAll:!0,showUncheckAll:!0,showEnableSearchButton:!1,closeOnSelect:!1,buttonClasses:"btn btn-default",closeOnDeselect:!1,groupBy:void 0,checkBoxes:!1,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:angular.noop,styleActive:!1,selectedToTop:!1,keyboardControls:!1,template:"{{getPropertyForObject(option, settings.displayProp)}}",searchField:"$",showAllSelectedText:!1},n={checkAll:"全选",uncheckAll:"全不选",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Search...",buttonDefaultText:"选择",dynamicButtonTextSuffix:"checked",disableSearch:"Disable search",enableSearch:"Enable search",selectGroup:"选择全部:",allSelectedText:"All"},d={searchFilter:s.searchFilter||""};angular.extend(a,s.extraSettings||[]),angular.extend(t,s.events||[]),angular.extend(n,s.translationTexts),a.closeOnBlur&&e.on("click",function(e){if(s.open){for(var t=e.target.parentElement,n=!1;angular.isDefined(t)&&null!==t&&!n;)t.className.split&&u(t.className.split(" "),"multiselect-parent")&&!n&&t===c&&(n=!0),t=t.parentElement;n||s.$apply(function(){s.close()})}}),angular.extend(s,{toggleDropdown:function(){s.open?s.close():s.open=!0,s.settings.keyboardControls&&s.open&&(1===s.settings.selectionLimit&&s.settings.enableSearch?setTimeout(function(){angular.element(i)[0].querySelector(".searchField").focus()},0):o()),s.settings.enableSearch&&s.open&&setTimeout(function(){angular.element(i)[0].querySelector(".searchField").focus()},0)},checkboxClick:function(e,t){s.setSelectedItem(t,!1,!0),e.stopImmediatePropagation()},externalEvents:t,settings:a,texts:n,input:d,close:function(){s.open=!1,s.input.searchFilter=s.settings.clearSearchOnClose?"":s.input.searchFilter,s.externalEvents.onClose()},selectCurrentGroup:function(t){s.selectedModel.splice(0,s.selectedModel.length),s.options.forEach(function(e){e[s.settings.groupBy]===t&&s.setSelectedItem(e,!1,!1)}),s.externalEvents.onSelectionChanged()},getGroupLabel:function(e){return null!==s.settings.groupByTextProvider?s.settings.groupByTextProvider(e):e},getButtonText:function(){if(s.settings.dynamicTitle&&s.selectedModel&&0<s.selectedModel.length){if(angular.isFunction(s.settings.smartButtonTextProvider))return s.settings.smartButtonTextProvider(s.selectedModel);if(0<s.settings.smartButtonMaxItems){var e=i[0].offsetWidth-24-2-8,l=[];angular.forEach(s.options,function(e){if(s.isChecked(e)){var t=s.getPropertyForObject(e,s.settings.displayProp),n=s.settings.smartButtonTextConverter(t,e);l.push(n||t)}}),s.selectedModel.length>s.settings.smartButtonMaxItems&&(l=l.slice(0,s.settings.smartButtonMaxItems)).push("...");var t=l.join(", "),n=t.length-4;if(0===i[0].offsetWidth)return t;if(e<=r("..."))return"...";for(;r(t)>e;)"..."!==l[l.length-1]&&(l.push("..."),n=(t+="...").length-4),t=t.slice(0,n)+t.slice(n+1),--n;return t}var o=angular.isDefined(s.selectedModel)?s.selectedModel.length:0;return 0===o?s.texts.buttonDefaultText:s.settings.showAllSelectedText&&o===s.options.length?s.texts.allSelectedText:o+" "+s.texts.dynamicButtonTextSuffix}return s.texts.buttonDefaultText},getPropertyForObject:function(e,t){return angular.isDefined(e)&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},selectAll:function(){s.deselectAll(!0),s.externalEvents.onSelectAll();var e=l("filter")(s.options,s.getFilter(s.input.searchFilter));angular.forEach(e,function(e){s.setSelectedItem(e,!0,!1)}),s.externalEvents.onSelectionChanged(),s.selectedGroup=null},deselectAll:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];e||s.externalEvents.onDeselectAll(),s.selectedModel.splice(0,s.selectedModel.length),e||s.externalEvents.onSelectionChanged(),s.selectedGroup=null},setSelectedItem:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=arguments[2],l=void 0,o=void 0;o=angular.isDefined(a.idProperty)?(l=-1!==g(s.selectedModel,e,a.idProperty),g(s.selectedModel,e,a.idProperty)):(l=-1!==s.selectedModel.indexOf(e),s.selectedModel.indexOf(e)),!t&&l?(s.selectedModel.splice(o,1),s.externalEvents.onItemDeselect(e),s.settings.closeOnDeselect&&s.close()):!l&&(0===s.settings.selectionLimit||s.selectedModel.length<s.settings.selectionLimit)?(s.selectedModel.push(e),n&&s.externalEvents.onItemSelect(e),s.settings.closeOnSelect&&s.close(),0<s.settings.selectionLimit&&s.selectedModel.length===s.settings.selectionLimit&&s.externalEvents.onMaxSelectionReached()):1!==s.settings.selectionLimit||l||s.selectedModel.length!==s.settings.selectionLimit||(s.selectedModel.splice(0,1),s.selectedModel.push(e),n&&s.externalEvents.onItemSelect(e),s.settings.closeOnSelect&&s.close()),n&&s.externalEvents.onSelectionChanged(),s.selectedGroup=null},isChecked:function(e){return angular.isDefined(a.idProperty)?-1!==g(s.selectedModel,e,a.idProperty):-1!==s.selectedModel.indexOf(e)},keyDownLink:function(e){var t=angular.element(e.target).scope(),n=void 0,l=e.target.parentNode;if(s.settings.keyboardControls)if(13===e.keyCode||32===e.keyCode)e.preventDefault(),t.option?s.setSelectedItem(t.option,!1,!0):"deselectAll"===e.target.id?s.deselectAll():"selectAll"===e.target.id&&s.selectAll();else if(38===e.keyCode){for(e.preventDefault(),l.previousElementSibling&&(n=l.previousElementSibling.querySelector("a")||l.previousElementSibling.querySelector("input"));!n&&l;)(l=l.previousElementSibling)&&(n=l.querySelector("a")||l.querySelector("input"));n&&n.focus()}else if(40===e.keyCode){for(e.preventDefault(),l.nextElementSibling&&(n=l.nextElementSibling.querySelector("a")||l.nextElementSibling.querySelector("input"));!n&&l;)(l=l.nextElementSibling)&&(n=l.querySelector("a")||l.querySelector("input"));n&&n.focus()}else 27===e.keyCode&&(e.preventDefault(),s.toggleDropdown())},keyDownSearchDefault:function(e){var t=e.target.parentNode.parentNode,n=void 0;if(s.settings.keyboardControls)if(9===e.keyCode||40===e.keyCode)e.preventDefault(),o();else if(38===e.keyCode){for(e.preventDefault(),t.previousElementSibling&&(n=t.previousElementSibling.querySelector("a")||t.previousElementSibling.querySelector("input"));!n&&t;)(t=t.previousElementSibling)&&(n=t.querySelector("a")||t.querySelector("input"));n&&n.focus()}else 27===e.keyCode&&(e.preventDefault(),s.toggleDropdown())},keyDownSearch:function(e,t){var n=void 0;s.settings.keyboardControls&&13===e.keyCode&&(1===s.settings.selectionLimit&&s.settings.enableSearch?1===(n=l("filter")(s.options,s.getFilter(t))).length&&s.setSelectedItem(n[0],!1,!0):s.settings.enableSearch&&s.selectAll())},getFilter:function(e){var t={};return t[s.settings.searchField]=e,t},toggleSearch:function(e){e&&e.stopPropagation(),s.settings.enableSearch=!s.settings.enableSearch,s.settings.enableSearch||(s.input.searchFilter="")},keyDownToggleSearch:function(){s.settings.keyboardControls&&13===event.keyCode&&(s.toggleSearch(),s.settings.enableSearch?setTimeout(function(){angular.element(i)[0].querySelector(".searchField").focus()},0):o())},orderFunction:function(e,t){if(angular.isUndefined(t))return-1;if(angular.isUndefined(e))return 1;if("object"!==e.type||"object"!==t.type)return e.index<t.index?-1:1;var n=e.value,l=t.value;return s.settings.groupBy&&n[s.settings.groupBy]!==l[s.settings.groupBy]?n[s.settings.groupBy]<l[s.settings.groupBy]?1:-1:s.settings.selectedToTop?!s.isChecked(n)&&!s.isChecked(l)||s.isChecked(n)&&s.isChecked(l)?s.options.indexOf(n)<s.options.indexOf(l)?-1:1:s.isChecked(n)?-1:1:s.options.indexOf(n)<s.options.indexOf(l)?-1:1}}),s.externalEvents.onInitDone()}n.$inject=["$scope","$element","$filter","$document"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}]),angular.module("angularjs-dropdown-multiselect").run(["$templateCache",function(e){e.put("app/component/angularjs-dropdown-multiselect.html",'<div class="multiselect-parent btn-group dropdown-multiselect" ng-class="{open: open}"><div ng-transclude=toggleDropdown ng-click=toggleDropdown()><button ng-disabled=disabled type=button class=dropdown-toggle ng-class=settings.buttonClasses>{{getButtonText()}} <span class=caret></span></button></div><ul class="dropdown-menu dropdown-menu-form" ng-if=open ng-style="{display: open ? \'block\' : \'none\', height : settings.scrollable ? settings.scrollableHeight : \'auto\', overflow: \'auto\' }"><li ng-if="settings.showCheckAll && settings.selectionLimit === 0"><a ng-keydown=keyDownLink($event) data-ng-click=selectAll() tabindex=-1 id=selectAll><span class="glyphicon glyphicon-ok"></span> {{texts.checkAll}}</a></li><li ng-if=settings.showUncheckAll><a ng-keydown=keyDownLink($event) data-ng-click=deselectAll(); tabindex=-1 id=deselectAll><span class="glyphicon glyphicon-remove"></span> {{texts.uncheckAll}}</a></li><li ng-if="settings.selectByGroups && ((settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll)" class=divider></li><li ng-repeat="currentGroup in settings.selectByGroups track by $index" ng-click=selectCurrentGroup(currentGroup)><a ng-class="{\'dropdown-selected-group\': selectedGroup === currentGroup}" tabindex=-1>{{::texts.selectGroup}} {{::getGroupLabel(currentGroup)}}</a></li><li ng-if="settings.selectByGroups && settings.showEnableSearchButton" class=divider></li><li ng-if="settings.showEnableSearchButton && settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.disableSearch}}</a></li><li ng-if="settings.showEnableSearchButton && !settings.enableSearch"><a ng-keydown="keyDownLink($event); keyDownToggleSearch();" ng-click=toggleSearch($event); tabindex=-1>{{texts.enableSearch}}</a></li><li ng-if="(settings.showCheckAll && settings.selectionLimit > 0) || settings.showUncheckAll || settings.showEnableSearchButton" class=divider></li><li ng-if=settings.enableSearch><div class=dropdown-header><input type=text class="form-control searchField" ng-keydown="keyDownSearchDefault($event); keyDownSearch($event, input.searchFilter);" ng-style="{width: \'100%\'}" ng-model=input.searchFilter placeholder={{texts.searchPlaceholder}}></div></li><li ng-if=settings.enableSearch class=divider></li><li ng-if=settings.groupBy ng-repeat-start="option in orderedItems = ( options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction)" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role=presentation class=dropdown-header>{{ getGroupLabel(getPropertyForObject(option, settings.groupBy)) }}</li><li ng-if=settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" ng-repeat-end role=presentation><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span dm-dropdown-static-include={{settings.template}}></span></a></li><li ng-if=!settings.groupBy ng-class="{\'active\': isChecked(option) && settings.styleActive}" role=presentation ng-repeat="option in options | filter:getFilter(input.searchFilter) | orderBy:\'\':false:orderFunction"><a ng-keydown="option.disabled || keyDownLink($event)" role=menuitem class=option tabindex=-1 ng-click="option.disabled || setSelectedItem(option, false, true)" ng-disabled=option.disabled><div ng-if=settings.checkBoxes class=checkbox><label><input class=checkboxInput type=checkbox ng-click="checkboxClick($event, option)" ng-checked=isChecked(option)> <span dm-dropdown-static-include={{settings.template}}></span></label></div><span ng-if=!settings.checkBoxes data-ng-class="{\'glyphicon glyphicon-ok\': isChecked(option)}"></span> <span ng-if=!settings.checkBoxes dm-dropdown-static-include={{settings.template}}></span></a></li><li class=divider ng-show="settings.selectionLimit > 1"></li><li role=presentation ng-show="settings.selectionLimit > 1"><a role=menuitem>{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li></ul></div>')}]);
